<?php
/* @var \Tangibledesign\Listivo\Widgets\User\UserViberWidget $lstCurrentWidget */
global $lstCurrentWidget;
$lstUser = $lstCurrentWidget->getUser();

if (!$lstUser || !$lstUser->hasViber() || tdf_settings()->disableViber()) {
    return;
}

$lstModel = $lstCurrentWidget->getModel();
$lstInitialMessage = $lstCurrentWidget->getInitialMessage($lstModel);
?>
<a
        class="listivo-contact-button"
        href="viber://chat?number=<?php echo esc_attr(str_replace('+', '', $lstUser->getPhoneUrl())); ?>&text=<?php echo esc_attr($lstInitialMessage); ?>"
        target="_blank"
>
    <div class="listivo-contact-button__inner">
        <div class="listivo-contact-button__icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M9.39453 0.000822919C7.71556 0.0112151 4.31091 0.170769 2.1084 2.05975C2.0977 2.06878 2.08728 2.07809 2.07715 2.08768C0.63765 3.47269 0 5.45809 0 8.10344V9.53222C0 12.1776 0.641741 14.1671 2.10938 15.5778C2.1195 15.5877 2.12992 15.5973 2.14062 15.6066C2.77111 16.1465 3.58685 16.5439 4.5 16.8613V18.5703C4.5 19.1607 4.88598 19.6943 5.46387 19.9051C5.63816 19.9687 5.82111 20 6 20C6.41862 20 6.82705 19.8321 7.11621 19.5253C7.12544 19.5158 8.26645 18.3396 8.95703 17.6134C9.35881 17.6253 9.7707 17.6348 9.99902 17.6348C11.286 17.6348 15.374 17.7356 17.8916 15.5768C17.9023 15.5675 17.9127 15.5579 17.9229 15.548C19.3624 14.163 20 12.1776 20 9.53222L19.999 8.10344C19.999 5.45764 19.3581 3.46826 17.8906 2.05882C17.8805 2.04923 17.8701 2.03992 17.8594 2.0309C15.3688 -0.1033 11.287 0.000822919 10 0.000822919C9.83912 0.000822919 9.63438 -0.000661691 9.39453 0.000822919ZM10 1.43053C11.284 1.43053 15.0176 1.53765 16.8408 3.0855C17.962 4.17295 18.499 5.68205 18.499 8.10344L18.5 9.53315C18.4998 11.9531 17.9593 13.4662 16.873 14.5222C15.0133 16.1026 11.2831 16.2051 9.99902 16.2051C9.69152 16.2051 9.22986 16.2052 8.67188 16.1781C8.55998 16.1726 8.44822 16.1911 8.34479 16.2322C8.24137 16.2733 8.14891 16.3359 8.07422 16.4155C7.48299 17.046 6.00879 18.5601 6.00879 18.5601C6.00583 18.5631 6.0029 18.5662 6 18.5694V16.381C6.00003 16.2272 5.94797 16.0774 5.85155 15.954C5.75514 15.8305 5.61952 15.7401 5.46484 15.696C4.47543 15.4134 3.71088 15.0202 3.16016 14.553C2.03753 13.4638 1.5 11.9538 1.5 9.53222V8.10344C1.5 5.68356 2.04018 4.17049 3.12598 3.11435C4.98502 1.53356 8.71583 1.43053 10 1.43053ZM10 3.33774C9.724 3.33774 9.5 3.55125 9.5 3.81431C9.5 4.07738 9.724 4.29088 10 4.29088C12.481 4.29088 14.5 6.21527 14.5 8.58001V9.05658C14.5 9.31965 14.724 9.53315 15 9.53315C15.276 9.53315 15.5 9.31965 15.5 9.05658V8.58001C15.5 5.68961 13.0325 3.33774 10 3.33774ZM6.04492 3.81431C5.72542 3.81384 5.30646 3.96457 5.02246 4.16615C4.59546 4.46973 4.1488 4.88291 4.0293 5.3976C4.0133 5.46766 4.00398 5.53836 4.00098 5.6089C3.97798 6.14504 4.19802 6.68946 4.43652 7.1503C4.99802 8.2364 5.7413 9.28775 6.5498 10.2266C6.8083 10.5268 7.09034 10.8057 7.38184 11.0755C7.66484 11.3528 7.95746 11.6217 8.27246 11.8685C9.25746 12.6391 10.3605 13.3476 11.5 13.8828C11.979 14.1077 12.5426 14.3141 13.0996 14.2988C13.1791 14.2965 13.2594 14.2876 13.3389 14.2709C13.8789 14.1575 14.3124 13.7313 14.6309 13.3243C14.8424 13.0536 15.0005 12.6548 15 12.3498C14.9995 12.1696 14.9136 11.9973 14.7256 11.8462C14.1701 11.4001 13.9135 11.2659 13.1465 10.827C12.827 10.6444 12.3405 10.4863 12.085 10.4863C11.9105 10.4863 11.7012 10.6137 11.5732 10.7357C11.2452 11.0484 11.1375 11.4394 10.5625 11.4394C10 11.4394 9.0175 10.8938 8.3125 10.1884C7.5725 9.51647 7 8.58001 7 8.04387C7 7.49581 7.40345 7.38615 7.73145 7.07304C7.85945 6.95152 8 6.75256 8 6.58624C8 6.34271 7.83408 5.8855 7.64258 5.58097C7.18208 4.84944 7.04174 4.60486 6.57324 4.07587C6.41474 3.89668 6.23392 3.81479 6.04492 3.81431ZM10.2139 4.77583C9.94237 4.76153 9.70298 4.96327 9.68848 5.22634C9.67398 5.48893 9.88513 5.71329 10.1611 5.72711C11.7531 5.80717 13 7.0607 13 8.58001C13 8.84308 13.224 9.05658 13.5 9.05658C13.776 9.05658 14 8.84308 14 8.58001C14 6.55363 12.3374 4.88258 10.2139 4.77583ZM10.4268 6.26976C10.2337 6.29717 10.0674 6.43074 10.0156 6.62161C9.94662 6.87657 10.1075 7.13618 10.375 7.20243C10.8985 7.3311 11.3083 7.72264 11.4453 8.22351C11.5038 8.43797 11.7067 8.58001 11.9287 8.58001C11.9702 8.58001 12.0132 8.57467 12.0557 8.56419C12.3227 8.49747 12.4826 8.2374 12.4131 7.98244C12.1846 7.14749 11.5 6.49589 10.626 6.28C10.5589 6.26368 10.4911 6.26063 10.4268 6.26976Z"
                      fill="#2A3946"/>
            </svg>
        </div>

        <?php echo esc_html(tdf_string('chat_via_viber')); ?>
    </div>
</a>